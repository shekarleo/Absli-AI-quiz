<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ABSLI Digi Tech ‚Äî Quiz Admin</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{--bg:#020810;--surface:#0a1525;--surface2:#0f1e33;--surface3:#152540;--accent:#00d4ff;--accent2:#7c3aed;--accent3:#f59e0b;--green:#10b981;--red:#ef4444;--text:#e2eaf5;--muted:#4a6a8e;--border:rgba(0,212,255,0.12);}
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Syne',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;}
  body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(0,212,255,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(0,212,255,0.02) 1px,transparent 1px);background-size:50px 50px;pointer-events:none;z-index:0;}
  .shell{display:flex;min-height:100vh;}
  .sidebar{width:220px;flex-shrink:0;background:var(--surface);border-right:1px solid var(--border);padding:24px 16px;position:fixed;top:0;left:0;height:100vh;z-index:10;overflow-y:auto;display:flex;flex-direction:column;}
  .main{margin-left:220px;flex:1;padding:28px 28px 60px;position:relative;z-index:1;}
  .logo{margin-bottom:28px;}
  .logo-badge{font-family:'Space Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--accent);text-transform:uppercase;margin-bottom:6px;}
  .logo-title{font-size:17px;font-weight:800;color:#fff;line-height:1.2;}
  .logo-sub{font-size:11px;color:var(--muted);margin-top:3px;}
  .nav-section{font-family:'Space Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted);text-transform:uppercase;margin:20px 0 8px;}
  .nav-item{display:flex;align-items:center;gap:8px;padding:9px 12px;border-radius:8px;cursor:pointer;font-size:13px;color:var(--muted);transition:all 0.2s;margin-bottom:2px;}
  .nav-item:hover,.nav-item.active{background:rgba(0,212,255,0.08);color:var(--accent);}
  .nav-item.active{border-left:2px solid var(--accent);}
  .sidebar-footer{margin-top:auto;padding-top:20px;border-top:1px solid var(--border);font-size:11px;color:var(--muted);line-height:1.7;}
  .topbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:28px;flex-wrap:wrap;gap:12px;}
  .page-title{font-size:22px;font-weight:800;color:#fff;}
  .page-sub{font-size:13px;color:var(--muted);margin-top:3px;}
  .topbar-actions{display:flex;gap:10px;flex-wrap:wrap;}
  .btn{padding:9px 18px;border:none;border-radius:10px;font-family:'Syne',sans-serif;font-size:13px;font-weight:700;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;gap:7px;}
  .btn-primary{background:linear-gradient(135deg,var(--accent2),var(--accent));color:#fff;}
  .btn-green{background:linear-gradient(135deg,#059669,#10b981);color:#fff;}
  .btn-ghost{background:var(--surface2);border:1px solid var(--border);color:var(--text);}
  .btn:hover{opacity:0.88;}
  .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(155px,1fr));gap:16px;margin-bottom:28px;}
  .stat-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:20px 18px;position:relative;overflow:hidden;}
  .stat-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;}
  .stat-card.blue::before{background:linear-gradient(90deg,var(--accent2),var(--accent));}
  .stat-card.green::before{background:linear-gradient(90deg,#059669,var(--green));}
  .stat-card.amber::before{background:linear-gradient(90deg,#d97706,var(--accent3));}
  .stat-card.purple::before{background:linear-gradient(90deg,var(--accent2),#a78bfa);}
  .stat-card.red::before{background:linear-gradient(90deg,#dc2626,var(--red));}
  .stat-label{font-family:'Space Mono',monospace;font-size:10px;letter-spacing:1.5px;color:var(--muted);text-transform:uppercase;margin-bottom:10px;}
  .stat-value{font-family:'Space Mono',monospace;font-size:28px;font-weight:700;color:#fff;margin-bottom:4px;}
  .stat-sub{font-size:12px;color:var(--muted);}
  .cat-breakdown{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin-bottom:28px;}
  .cat-card{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:18px;}
  .cat-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;}
  .cat-name{font-size:13px;font-weight:700;}
  .cat-pct-val{font-family:'Space Mono',monospace;font-size:20px;font-weight:700;}
  .cat-bar{height:6px;background:var(--surface3);border-radius:4px;overflow:hidden;}
  .cat-fill{height:100%;border-radius:4px;}
  .cat-meta{font-size:11px;color:var(--muted);margin-top:6px;}
  .c-tech .cat-pct-val{color:var(--accent);} .c-tech .cat-fill{background:linear-gradient(90deg,var(--accent2),var(--accent));}
  .c-func .cat-pct-val{color:#a78bfa;} .c-func .cat-fill{background:linear-gradient(90deg,#6d28d9,#a78bfa);}
  .c-fp .cat-pct-val{color:var(--accent3);} .c-fp .cat-fill{background:linear-gradient(90deg,#d97706,var(--accent3));}
  .chart-wrap{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:22px;margin-bottom:28px;}
  .chart-title{font-size:14px;font-weight:700;color:#fff;margin-bottom:4px;}
  .chart-sub{font-size:12px;color:var(--muted);margin-bottom:18px;}
  .dist-chart{display:flex;align-items:flex-end;gap:6px;height:100px;}
  .dist-bar-wrap{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;}
  .dist-bar{width:100%;border-radius:4px 4px 0 0;min-height:4px;background:linear-gradient(180deg,var(--accent),var(--accent2));}
  .dist-label{font-family:'Space Mono',monospace;font-size:9px;color:var(--muted);text-align:center;}
  .dist-count{font-family:'Space Mono',monospace;font-size:9px;color:var(--accent);}
  .filter-bar{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:16px;align-items:center;}
  .filter-bar input,.filter-bar select{background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:8px 12px;color:var(--text);font-family:'Syne',sans-serif;font-size:13px;outline:none;}
  .filter-bar input{flex:1;min-width:160px;}
  .filter-bar input:focus,.filter-bar select:focus{border-color:var(--accent);}
  .filter-bar select option{background:var(--surface2);}
  .table-wrap{background:var(--surface);border:1px solid var(--border);border-radius:16px;overflow:hidden;}
  .table-header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--border);}
  .table-title{font-size:14px;font-weight:700;color:#fff;}
  .table-meta{font-family:'Space Mono',monospace;font-size:11px;color:var(--muted);}
  table{width:100%;border-collapse:collapse;}
  thead th{padding:10px 14px;text-align:left;font-family:'Space Mono',monospace;font-size:10px;letter-spacing:1px;color:var(--muted);text-transform:uppercase;background:var(--surface2);border-bottom:1px solid var(--border);white-space:nowrap;}
  tbody tr{border-bottom:1px solid var(--border);transition:background 0.15s;}
  tbody tr:hover{background:rgba(0,212,255,0.03);}
  tbody tr:last-child{border-bottom:none;}
  tbody td{padding:11px 14px;font-size:13px;vertical-align:middle;}
  .score-col{font-family:'Space Mono',monospace;font-weight:700;}
  .pct-wrap{display:flex;align-items:center;gap:8px;}
  .pct-bg{height:5px;background:var(--surface3);border-radius:3px;flex:1;overflow:hidden;}
  .pct-fill{height:100%;border-radius:3px;}
  .pct-txt{font-family:'Space Mono',monospace;font-size:11px;width:36px;text-align:right;color:var(--muted);}
  .grade-pill{font-size:11px;padding:3px 8px;border-radius:20px;font-weight:700;white-space:nowrap;}
  .g-expert{background:rgba(245,158,11,0.12);color:var(--accent3);border:1px solid rgba(245,158,11,0.25);}
  .g-ready{background:rgba(0,212,255,0.08);color:var(--accent);border:1px solid rgba(0,212,255,0.2);}
  .g-growing{background:rgba(124,58,237,0.08);color:#a78bfa;border:1px solid rgba(124,58,237,0.2);}
  .g-learning{background:rgba(239,68,68,0.08);color:var(--red);border:1px solid rgba(239,68,68,0.2);}
  .empty-state{padding:48px;text-align:center;color:var(--muted);}
  .empty-icon{font-size:40px;margin-bottom:12px;}
  .loading-state{padding:40px;text-align:center;color:var(--muted);font-size:14px;}
  .section-label{font-family:'Space Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--muted);text-transform:uppercase;margin-bottom:12px;}
  .toast{position:fixed;bottom:24px;right:24px;background:var(--surface);border:1px solid var(--green);color:var(--green);padding:12px 20px;border-radius:12px;font-size:13px;font-weight:700;z-index:100;transform:translateY(60px);opacity:0;transition:all 0.3s;}
  .toast.show{transform:translateY(0);opacity:1;}
  /* Gate */
  .gate{position:fixed;inset:0;background:var(--bg);z-index:200;display:flex;align-items:center;justify-content:center;}
  .gate-card{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:40px 36px;max-width:380px;width:90%;text-align:center;}
  .gate-icon{font-size:48px;margin-bottom:16px;}
  .gate-title{font-size:22px;font-weight:800;color:#fff;margin-bottom:8px;}
  .gate-sub{color:var(--muted);font-size:14px;margin-bottom:24px;}
  .gate-input{width:100%;background:var(--surface2);border:1px solid var(--border);border-radius:10px;padding:12px 16px;color:var(--text);font-family:'Space Mono',monospace;font-size:16px;text-align:center;letter-spacing:4px;outline:none;margin-bottom:14px;transition:border-color 0.2s;}
  .gate-input:focus{border-color:var(--accent);}
  .gate-err{font-size:12px;color:var(--red);margin-bottom:12px;min-height:18px;}
  .gate-btn{width:100%;padding:13px;background:linear-gradient(135deg,var(--accent2),var(--accent));border:none;border-radius:12px;color:#fff;font-family:'Syne',sans-serif;font-size:16px;font-weight:700;cursor:pointer;}
  /* Setup banner */
  .setup-banner{background:rgba(245,158,11,0.08);border:1px solid rgba(245,158,11,0.25);border-radius:14px;padding:18px 20px;margin-bottom:24px;display:none;}
  .setup-banner.show{display:block;}
  .setup-banner-title{font-size:14px;font-weight:700;color:var(--accent3);margin-bottom:8px;}
  .setup-banner p{font-size:13px;color:var(--muted);line-height:1.7;}
  .setup-banner code{font-family:'Space Mono',monospace;background:rgba(0,212,255,0.08);padding:2px 6px;border-radius:4px;color:var(--accent);font-size:12px;}
  /* URL input */
  .url-row{display:flex;gap:10px;margin-top:14px;}
  .url-row input{flex:1;background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:10px 14px;color:var(--text);font-family:'Space Mono',monospace;font-size:12px;outline:none;}
  .url-row input:focus{border-color:var(--accent);}
  @media(max-width:768px){.sidebar{display:none;}.main{margin-left:0;padding:16px 14px 40px;}.stats-grid{grid-template-columns:repeat(2,1fr);}table thead tr th:nth-child(n+6){display:none;}table tbody tr td:nth-child(n+6){display:none;}}
  .dot-loader{display:inline-flex;gap:4px;margin-left:8px;}
  .dot-loader span{width:5px;height:5px;border-radius:50%;background:currentColor;animation:dotB 1.2s infinite;}
  .dot-loader span:nth-child(2){animation-delay:.2s;}
  .dot-loader span:nth-child(3){animation-delay:.4s;}
  @keyframes dotB{0%,80%,100%{transform:scale(0)}40%{transform:scale(1)}}
</style>
</head>
<body>

<!-- Gate -->
<div class="gate" id="gate">
  <div class="gate-card">
    <div class="gate-icon">üîê</div>
    <div class="gate-title">Admin Access</div>
    <div class="gate-sub">ABSLI Digi Tech Quiz Dashboard<br>Enter the admin password to continue</div>
    <input class="gate-input" type="password" id="gate-pwd" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="20">
    <div class="gate-err" id="gate-err"></div>
    <button class="gate-btn" onclick="checkPwd()">Access Dashboard ‚Üí</button>
    <p style="margin-top:14px;font-size:11px;color:var(--muted);">Default password: <span style="font-family:'Space Mono',monospace;color:var(--accent);">admin123</span></p>
  </div>
</div>

<div class="shell">
  <div class="sidebar">
    <div class="logo">
      <img src="data:image/jpeg;base64,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" alt="ABSLI" style="height:44px;object-fit:contain;border-radius:4px;margin-bottom:10px;display:block;"><div class="logo-badge">‚ö° Admin Panel</div>
      <div class="logo-title">ABSLI Digi Tech</div>
      <div class="logo-sub">AI Quiz Dashboard</div>
    </div>
    <div class="nav-section">Navigation</div>
    <div class="nav-item active" onclick="showSection('overview',this)">üìä Overview</div>
    <div class="nav-item" onclick="showSection('attempts',this)">üë• All Attempts</div>
    <div class="nav-item" onclick="showSection('leaderboard',this)">üèÜ Leaderboard</div>
    <div class="nav-section">Actions</div>
    <div class="nav-item" onclick="downloadCSV()">‚¨áÔ∏è Download CSV</div>
    <div class="nav-item" onclick="refreshAll()">üîÑ Refresh Data</div>
    <div class="sidebar-footer">Live data from Google Sheets.<br>Export CSV to save a snapshot.</div>
  </div>

  <div class="main">
    <div class="topbar">
      <div>
        <div class="page-title" id="page-title">Overview</div>
        <div class="page-sub" id="page-sub">Live quiz performance from Google Sheets</div>
      </div>
      <div class="topbar-actions">
        <button class="btn btn-green" onclick="downloadCSV()">‚¨áÔ∏è Export CSV</button>
        <button class="btn btn-ghost" onclick="refreshAll()">üîÑ Refresh</button>
      </div>
    </div>

    <!-- Setup Banner -->
    <div class="setup-banner" id="setup-banner">
      <div class="setup-banner-title">‚öôÔ∏è Google Sheets Not Connected</div>
      <p>Paste your Apps Script Web App URL below to connect live data. Follow the setup guide in <code>SETUP-GUIDE.md</code> to get your URL.</p>
      <div class="url-row">
        <input type="text" id="script-url-input" placeholder="https://script.google.com/macros/s/.../exec">
        <button class="btn btn-primary" onclick="saveScriptUrl()">Connect</button>
      </div>
    </div>

    <!-- Overview -->
    <div id="section-overview">
      <div class="section-label">Summary Stats</div>
      <div class="stats-grid" id="stats-grid"><div class="loading-state">Loading<div class="dot-loader"><span></span><span></span><span></span></div></div></div>
      <div class="section-label">Score Distribution</div>
      <div class="chart-wrap">
        <div class="chart-title">Participants by Score Band</div>
        <div class="chart-sub">Number of participants in each score range</div>
        <div class="dist-chart" id="dist-chart"></div>
      </div>
      <div class="section-label">Category Performance (Team Average)</div>
      <div class="cat-breakdown" id="cat-breakdown"></div>
    </div>

    <!-- Attempts -->
    <div id="section-attempts" style="display:none;">
      <div class="filter-bar">
        <input type="text" id="filter-name" placeholder="üîç Search by name or team..." oninput="renderTable()">
        <select id="filter-grade" onchange="renderTable()">
          <option value="">All Grades</option>
          <option value="AI Expert">AI Expert (90%+)</option>
          <option value="AI Ready">AI Ready (70-89%)</option>
          <option value="Growing">Growing (50-69%)</option>
          <option value="Keep Learning">Keep Learning (&lt;50%)</option>
        </select>
        <select id="sort-by" onchange="renderTable()">
          <option value="newest">Newest First</option>
          <option value="score-desc">Highest Score</option>
          <option value="score-asc">Lowest Score</option>
          <option value="time-asc">Fastest Time</option>
        </select>
      </div>
      <div class="table-wrap">
        <div class="table-header">
          <span class="table-title">All Submissions</span>
          <span class="table-meta" id="table-count">‚Äî</span>
        </div>
        <div style="overflow-x:auto;"><table><thead><tr>
          <th>#</th><th>Name</th><th>Team</th><th>Score</th><th>%</th><th>Grade</th>
          <th>Time</th><th>Technical</th><th>Functional</th><th>1st Principle</th><th>Submitted</th>
        </tr></thead><tbody id="attempts-tbody"></tbody></table></div>
      </div>
    </div>

    <!-- Leaderboard -->
    <div id="section-leaderboard" style="display:none;">
      <div class="table-wrap">
        <div class="table-header">
          <span class="table-title">üèÜ Best Score Leaderboard</span>
          <span class="table-meta" id="lb-count">‚Äî</span>
        </div>
        <div style="overflow-x:auto;"><table><thead><tr>
          <th>Rank</th><th>Name</th><th>Team</th><th>Best Score</th><th>%</th><th>Time</th><th>Date</th>
        </tr></thead><tbody id="lb-tbody"></tbody></table></div>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
// ‚îÄ‚îÄ‚îÄ ‚öôÔ∏è  PASTE YOUR APPS SCRIPT URL BELOW (or enter it in the dashboard) ‚îÄ‚îÄ
var SCRIPT_URL = localStorage.getItem('absli_admin_script_url') || 'PASTE_YOUR_APPS_SCRIPT_URL_HERE';
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

var ADMIN_PWD = 'admin123';
var Q_COUNT   = 15;
var allData   = [];

function checkPwd() {
  var v = document.getElementById('gate-pwd').value;
  if (v === ADMIN_PWD) { document.getElementById('gate').style.display='none'; init(); }
  else document.getElementById('gate-err').textContent = 'Incorrect password. Try again.';
}
document.getElementById('gate-pwd').addEventListener('keydown', function(e){ if(e.key==='Enter') checkPwd(); });

function init() {
  checkSetup();
  refreshAll();
}

function checkSetup() {
  var banner = document.getElementById('setup-banner');
  if (!SCRIPT_URL || SCRIPT_URL.includes('PASTE')) {
    banner.classList.add('show');
  } else {
    banner.classList.remove('show');
  }
}

function saveScriptUrl() {
  var url = document.getElementById('script-url-input').value.trim();
  if (!url || !url.startsWith('https://')) { showToast('‚ùå Please enter a valid URL'); return; }
  SCRIPT_URL = url;
  localStorage.setItem('absli_admin_script_url', url);
  checkSetup();
  refreshAll();
  showToast('‚úÖ Connected! Loading data...');
}

function fetchData() {
  if (!SCRIPT_URL || SCRIPT_URL.includes('PASTE')) return Promise.resolve([]);
  return fetch(SCRIPT_URL)
    .then(function(r){ return r.json(); })
    .then(function(d){ return d.submissions || []; })
    .catch(function(err){ console.error('Fetch error:', err); return []; });
}

function refreshAll() {
  document.getElementById('stats-grid').innerHTML='<div class="loading-state">Loading live data<div class="dot-loader"><span></span><span></span><span></span></div></div>';
  fetchData().then(function(rows) {
    allData = rows;
    renderStats();
    renderDistChart();
    renderCatBreakdown();
    renderTable();
    renderLB();
    showToast('‚úÖ Data refreshed ‚Äî '+rows.length+' submissions');
  });
}

function pctNum(row) {
  return parseInt(String(row['Percentage']||'0').replace('%',''), 10) || 0;
}
function scoreNum(row) { return parseInt(row['Score']||0, 10) || 0; }
function timeNum(row) {
  var t = String(row['Time (mm:ss)']||'99:99').split(':');
  return (parseInt(t[0],10)||0)*60+(parseInt(t[1],10)||0);
}
function gradeClass(g) {
  if(g==='AI Expert') return 'g-expert';
  if(g==='AI Ready')  return 'g-ready';
  if(g==='Growing')   return 'g-growing';
  return 'g-learning';
}
function esc(s){ return String(s||'').replace(/[<>&"]/g,function(c){return{'<':'&lt;','>':'&gt;','&':'&amp;','"':'&quot;'}[c];}); }

function renderStats() {
  var all = allData;
  if (!all.length) {
    document.getElementById('stats-grid').innerHTML = '<div style="grid-column:1/-1;padding:32px;text-align:center;color:var(--muted);">No submissions yet. Share the quiz with your team!</div>';
    document.getElementById('dist-chart').innerHTML = '';
    document.getElementById('cat-breakdown').innerHTML = '';
    return;
  }
  var avg = all.reduce(function(s,r){return s+pctNum(r);},0)/all.length;
  var best = Math.max.apply(null, all.map(pctNum));
  var pass = all.filter(function(r){return pctNum(r)>=50;}).length;
  var expert = all.filter(function(r){return pctNum(r)>=90;}).length;
  var avgTime = Math.round(all.reduce(function(s,r){return s+timeNum(r);},0)/all.length);
  var unique = {};
  all.forEach(function(r){ var k=(r['Name']||'').toLowerCase(); if(!unique[k]||pctNum(r)>pctNum(unique[k])) unique[k]=r; });
  var m=Math.floor(avgTime/60),sec=avgTime%60;
  var timeStr=String(m).padStart(2,'0')+':'+String(sec).padStart(2,'0');
  document.getElementById('stats-grid').innerHTML =
    '<div class="stat-card blue"><div class="stat-label">Total Attempts</div><div class="stat-value">'+all.length+'</div><div class="stat-sub">'+Object.keys(unique).length+' unique participants</div></div>'
    +'<div class="stat-card green"><div class="stat-label">Avg Score</div><div class="stat-value">'+avg.toFixed(1)+'%</div><div class="stat-sub">'+(avg/100*Q_COUNT).toFixed(1)+' / '+Q_COUNT+' avg correct</div></div>'
    +'<div class="stat-card amber"><div class="stat-label">Top Score</div><div class="stat-value">'+best+'%</div><div class="stat-sub">Best performance</div></div>'
    +'<div class="stat-card purple"><div class="stat-label">Pass Rate</div><div class="stat-value">'+Math.round(pass/all.length*100)+'%</div><div class="stat-sub">'+pass+' of '+all.length+' scored ‚â•50%</div></div>'
    +'<div class="stat-card blue"><div class="stat-label">AI Experts</div><div class="stat-value">'+expert+'</div><div class="stat-sub">Scored 90%+ üèÜ</div></div>'
    +'<div class="stat-card green"><div class="stat-label">Avg Time</div><div class="stat-value">'+timeStr+'</div><div class="stat-sub">Per attempt</div></div>';
}

function renderDistChart() {
  var all = allData;
  var bands = [{l:'0-20%',r:[0,20]},{l:'21-40%',r:[21,40]},{l:'41-60%',r:[41,60]},{l:'61-80%',r:[61,80]},{l:'81-100%',r:[81,100]}];
  var counts = bands.map(function(b){ return all.filter(function(r){var p=pctNum(r);return p>=b.r[0]&&p<=b.r[1];}).length; });
  var max = Math.max.apply(null, counts.concat([1]));
  document.getElementById('dist-chart').innerHTML = bands.map(function(b,i){
    return '<div class="dist-bar-wrap"><div class="dist-count">'+counts[i]+'</div>'
      +'<div class="dist-bar" style="height:'+(Math.round(counts[i]/max*80)+4)+'px;"></div>'
      +'<div class="dist-label">'+b.l+'</div></div>';
  }).join('');
}

function renderCatBreakdown() {
  var all = allData;
  if (!all.length) return;
  var cats = [
    {key:'Technical (/5)',  cls:'c-tech', label:'Technical'},
    {key:'Functional (/5)', cls:'c-func', label:'Functional'},
    {key:'First Principle (/5)', cls:'c-fp', label:'First Principle'}
  ];
  document.getElementById('cat-breakdown').innerHTML = cats.map(function(c){
    var total = all.length * 5;
    var correct = all.reduce(function(s,r){ return s+(parseInt(r[c.key]||0,10)||0); }, 0);
    var pct = total ? Math.round(correct/total*100) : 0;
    return '<div class="cat-card '+c.cls+'">'
      +'<div class="cat-header"><span class="cat-name">'+c.label+'</span><span class="cat-pct-val">'+pct+'%</span></div>'
      +'<div class="cat-bar"><div class="cat-fill" style="width:'+pct+'%"></div></div>'
      +'<div class="cat-meta">'+correct+' correct out of '+total+' possible</div></div>';
  }).join('');
}

function renderTable() {
  var all = allData.slice();
  var nameF = (document.getElementById('filter-name')||{}).value||'';
  var gradeF = (document.getElementById('filter-grade')||{}).value||'';
  var sortBy = (document.getElementById('sort-by')||{}).value||'newest';
  if (nameF) all = all.filter(function(r){ return (r['Name']||'').toLowerCase().includes(nameF.toLowerCase())||(r['Team']||'').toLowerCase().includes(nameF.toLowerCase()); });
  if (gradeF) all = all.filter(function(r){ return (r['Grade']||'')=== gradeF; });
  if (sortBy==='score-desc') all.sort(function(a,b){return pctNum(b)-pctNum(a)||timeNum(a)-timeNum(b);});
  else if (sortBy==='score-asc') all.sort(function(a,b){return pctNum(a)-pctNum(b);});
  else if (sortBy==='time-asc') all.sort(function(a,b){return timeNum(a)-timeNum(b);});
  // newest = keep original order (reversed)
  else all.reverse();
  document.getElementById('table-count').textContent = all.length+' record'+(all.length!==1?'s':'');
  if (!all.length) {
    document.getElementById('attempts-tbody').innerHTML='<tr><td colspan="11"><div class="empty-state"><div class="empty-icon">üì≠</div><div class="empty-msg">No records found</div></div></td></tr>';
    return;
  }
  var Q = Q_COUNT;
  document.getElementById('attempts-tbody').innerHTML = all.map(function(r,i){
    var p = pctNum(r);
    var scoreVal = scoreNum(r);
    var g = r['Grade']||'';
    var tech = parseInt(r['Technical (/5)']||0,10);
    var func = parseInt(r['Functional (/5)']||0,10);
    var fp   = parseInt(r['First Principle (/5)']||0,10);
    var techP = Math.round(tech/5*100), funcP=Math.round(func/5*100), fpP=Math.round(fp/5*100);
    var barColor = p>=70?'linear-gradient(90deg,#059669,#10b981)':p>=50?'linear-gradient(90deg,#d97706,#f59e0b)':'linear-gradient(90deg,#dc2626,#ef4444)';
    var scoreColor = p>=70?'var(--green)':p>=50?'var(--accent3)':'var(--red)';
    return '<tr>'
      +'<td style="color:var(--muted);font-family:\'Space Mono\',monospace;font-size:11px;">'+(i+1)+'</td>'
      +'<td style="font-weight:700;">'+esc(r['Name'])+'</td>'
      +'<td style="color:var(--muted);font-size:12px;">'+esc(r['Team']||'‚Äî')+'</td>'
      +'<td class="score-col" style="color:'+scoreColor+';">'+scoreVal+'/'+Q+'</td>'
      +'<td><div class="pct-wrap"><div class="pct-bg"><div class="pct-fill" style="width:'+p+'%;background:'+barColor+'"></div></div><span class="pct-txt">'+p+'%</span></div></td>'
      +'<td><span class="grade-pill '+gradeClass(g)+'">'+esc(g)+'</span></td>'
      +'<td style="font-family:\'Space Mono\',monospace;font-size:12px;color:var(--muted);">'+esc(r['Time (mm:ss)']||'‚Äî')+'</td>'
      +'<td style="font-size:12px;color:'+(techP>=60?'var(--green)':'var(--muted)')+'">'+tech+'/5 <span style="color:var(--muted)">('+techP+'%)</span></td>'
      +'<td style="font-size:12px;color:'+(funcP>=60?'var(--green)':'var(--muted)')+'">'+func+'/5 <span style="color:var(--muted)">('+funcP+'%)</span></td>'
      +'<td style="font-size:12px;color:'+(fpP>=60?'var(--green)':'var(--muted)')+'">'+fp+'/5 <span style="color:var(--muted)">('+fpP+'%)</span></td>'
      +'<td style="font-size:11px;color:var(--muted);">'+esc(r['Submitted At']||r['date']||'‚Äî')+'</td>'
      +'</tr>';
  }).join('');
}

function renderLB() {
  var all = allData;
  var best = {};
  all.forEach(function(r){
    var name=(r['Name']||'').toLowerCase();
    var p=pctNum(r);
    if(!best[name]||p>pctNum(best[name])||(p===pctNum(best[name])&&timeNum(r)<timeNum(best[name]))) best[name]=r;
  });
  var lb = Object.values(best).sort(function(a,b){return pctNum(b)-pctNum(a)||timeNum(a)-timeNum(b);});
  document.getElementById('lb-count').textContent = lb.length+' participant'+(lb.length!==1?'s':'');
  var medals=['ü•á','ü•à','ü•â'];
  if (!lb.length) {
    document.getElementById('lb-tbody').innerHTML='<tr><td colspan="7"><div class="empty-state"><div class="empty-icon">üèÜ</div><div class="empty-msg">No submissions yet</div></div></td></tr>';
    return;
  }
  document.getElementById('lb-tbody').innerHTML = lb.map(function(r,i){
    var p=pctNum(r);
    return '<tr>'
      +'<td style="font-family:\'Space Mono\',monospace;font-weight:700;">'+(medals[i]||(i+1))+'</td>'
      +'<td style="font-weight:700;">'+esc(r['Name'])+'</td>'
      +'<td style="color:var(--muted);font-size:12px;">'+esc(r['Team']||'‚Äî')+'</td>'
      +'<td class="score-col" style="color:var(--accent);">'+scoreNum(r)+'/'+Q_COUNT+'</td>'
      +'<td><div class="pct-wrap"><div class="pct-bg"><div class="pct-fill" style="width:'+p+'%"></div></div><span class="pct-txt">'+p+'%</span></div></td>'
      +'<td style="font-family:\'Space Mono\',monospace;font-size:12px;color:var(--muted);">'+esc(r['Time (mm:ss)']||'‚Äî')+'</td>'
      +'<td style="font-size:11px;color:var(--muted);">'+esc(r['Submitted At']||'‚Äî')+'</td>'
      +'</tr>';
  }).join('');
}

function downloadCSV() {
  if (!allData.length) { showToast('‚ùå No data to export'); return; }
  var headers = ['Name','Team','Score','Percentage','Grade','Time (mm:ss)','Technical (/5)','Functional (/5)','First Principle (/5)','Submitted At'];
  var rows = allData.map(function(r){
    return headers.map(function(h){ return '"'+(String(r[h]||'').replace(/"/g,'""'))+'"'; }).join(',');
  });
  var csv = [headers.join(',')].concat(rows).join('\n');
  var blob = new Blob([csv], {type:'text/csv'});
  var url = URL.createObjectURL(blob);
  var a = document.createElement('a'); a.href=url;
  a.download='ABSLI_AI_Quiz_'+new Date().toISOString().slice(0,10)+'.csv';
  a.click(); URL.revokeObjectURL(url);
  showToast('‚úÖ CSV downloaded ‚Äî '+allData.length+' records');
}

function showSection(id, el) {
  ['overview','attempts','leaderboard'].forEach(function(s){
    document.getElementById('section-'+s).style.display = s===id?'block':'none';
  });
  document.querySelectorAll('.nav-item').forEach(function(n){n.classList.remove('active');});
  el.classList.add('active');
  var titles={overview:['Overview','Live quiz performance from Google Sheets'],attempts:['All Submissions','Every quiz attempt with detailed breakdown'],leaderboard:['Leaderboard','Best score per participant']};
  document.getElementById('page-title').textContent=titles[id][0];
  document.getElementById('page-sub').textContent=titles[id][1];
}

function showToast(msg) {
  var t=document.getElementById('toast'); t.textContent=msg; t.classList.add('show');
  setTimeout(function(){t.classList.remove('show');},3000);
}
</script>
</body>
</html>
